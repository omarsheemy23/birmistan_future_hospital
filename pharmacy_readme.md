# نظام الصيدلية - مستشفى بيرمستان المستقبل

## نظرة عامة
نظام الصيدلية في مستشفى بيرمستان المستقبل يتيح إدارة كاملة للأدوية والروشتات الطبية، ويتضمن المميزات التالية:

- صرف الروشتات الطبية ومتابعة حالتها
- إدارة مخزون الأدوية
- مراقبة تواريخ انتهاء الصلاحية
- تنبيهات للمخزون المنخفض
- تسجيل دخول للصيادلة

## الاستخدام
يتضمن نظام الصيدلية الصفحات التالية:

### لوحة التحكم (dashboard.php)
تعرض إحصائيات سريعة عن:
- عدد الروشتات الجديدة
- الأدوية منخفضة المخزون
- الأدوية التي تنتهي صلاحيتها قريباً
- آخر الروشتات المسجلة

### عرض الروشتات (view_prescriptions.php)
- قائمة بجميع الروشتات المسجلة
- إمكانية تصفية الروشتات حسب الحالة (مفتوحة/مغلقة)
- عرض تفاصيل الروشتة والمريض والطبيب

### صرف الدواء (dispense_medicine.php)
- صرف الأدوية للمرضى بناءً على الروشتة الطبية
- البحث عن روشتة باستخدام رقم الروشتة أو اسم المريض
- عرض قائمة الروشتات المفتوحة للصرف

### تفاصيل الروشتة (prescription_details.php)
- عرض كافة تفاصيل الروشتة
- معلومات المريض والطبيب
- الأدوية المطلوبة والجرعات
- إمكانية صرف الروشتة وتحديث حالتها

### إدارة الأدوية (inventory.php)
- عرض مخزون الأدوية
- إضافة/تعديل/حذف الأدوية
- تحديث كميات المخزون
- تتبع تواريخ انتهاء الصلاحية

## التثبيت والإعداد

1. تأكد من تثبيت XAMPP وتشغيل خدمات Apache و MySQL.

2. ضع جميع الملفات في مجلد `htdocs` الخاص بـ XAMPP.

3. قم بتنفيذ ملف `create_prescription_tables.php` لإنشاء جداول قاعدة البيانات اللازمة:
   - قم بزيارة: `http://localhost/birmistan_future_hospital/create_prescription_tables.php`

4. إذا كانت هناك مشاكل في الجداول يمكنك تنفيذ ملف `setup_pharmacy_db.sql` مباشرة في phpMyAdmin.

5. للوصول إلى نظام الصيدلية، قم بتسجيل الدخول كصيدلي:
   - افتح: `http://localhost/birmistan_future_hospital/login.php`
   - سجل دخول باستخدام حساب صيدلي أو قم بإنشاء حساب جديد من صفحة التسجيل.

6. بعد تسجيل الدخول، سيتم توجيهك إلى لوحة تحكم الصيدلية.

## حل المشكلات الشائعة

### مشكلة: جدول `prescription_medicines` غير موجود
الحل: قم بتنفيذ ملف `create_prescription_tables.php` لإنشاء الجدول المفقود.

### مشكلة: خطأ في اتصال قاعدة البيانات
الحل: تأكد من إعدادات الاتصال في ملف `includes/config.php`.

### مشكلة: عدم القدرة على صرف الدواء
الحل: تأكد من وجود كمية كافية من الدواء في المخزون وأن الروشتة في حالة "مفتوحة".

### مشكلة: عدم عرض الأدوية في الروشتة
الحل: تأكد من وجود سجلات في جدول `prescription_medicines` مرتبطة برقم الروشتة.

## الجداول المستخدمة

1. `users` - جدول المستخدمين (يتضمن الصيادلة)
2. `pharmacists` - بيانات الصيادلة
3. `medicines` - قائمة الأدوية المتاحة
4. `prescriptions` - الروشتات الطبية
5. `prescription_medicines` - الأدوية في كل روشتة
6. `dispensed_medicines` - سجل صرف الأدوية

## ملاحظات هامة

- نظام الصيدلية مرتبط بباقي أنظمة المستشفى مثل نظام تسجيل المرضى ونظام الأطباء.
- يجب أن يكون لديك حساب صيدلي لاستخدام النظام.
- لا يمكن حذف الأدوية المرتبطة بروشتات قائمة.
- يتم تحديث المخزون تلقائياً عند صرف الدواء. 